!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FaceAuth=e():n.FaceAuth=e()}(this,()=>{return n={291:function(n){n.exports=function(){"use strict";return class{constructor(n={}){if(this.config={detectionInterval:200,progressStep:1,progressIntervalTime:100,minFaceSize:.3,maxFaceSize:.6,centerThreshold:.15,warningThreshold:.25,onCapture:null,onClose:null,onError:null,...n},this.stream=null,this.progressInterval=null,this.progress=0,this.isCentered=!1,this.isCapturing=!1,this.faceDetectionModel=null,this.detectionInterval=null,this.voiceEnabled=!0,this.isSpeaking=!1,this.foreignObjectDetected=!1,this.faceValidationChecks={hasBothEyes:!1,hasNose:!1,hasMouth:!1,isFullFace:!1},"undefined"==typeof faceLandmarksDetection)throw new Error("FaceLandmarksDetection is required. Please include it before FaceAuth.");if("undefined"==typeof tf)throw new Error("TensorFlow.js is required. Please include it before FaceAuth.");this.initDOM(),this.initEventListeners(),this.initVoice()}initDOM(){document.getElementById("faceAuthOverlay")||this.createPopupStructure(),this.cacheDOMElements()}createPopupStructure(){const n=document.createElement("div");n.className="face-auth-overlay",n.id="faceAuthOverlay";const e=document.createElement("div");e.className="face-auth-popup",e.id="faceAuthPopup",e.innerHTML='\n                <div class="face-auth-header">\n                    <div>\n                        <div class="face-auth-title">Xác Thực Khuôn Mặt</div>\n                        <div class="face-auth-subtitle">Hệ thống sẽ hướng dẫn bạn định vị khuôn mặt</div>\n                    </div>\n                    <div class="face-auth-header-controls">\n                        <button class="face-auth-voice-toggle" id="faceAuthVoiceToggle" title="Bật/Tắt giọng nói">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>\n                                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>\n                                <line x1="12" y1="19" x2="12" y2="23"></line>\n                                <line x1="8" y1="23" x2="16" y2="23"></line>\n                            </svg>\n                        </button>\n                        <button class="face-auth-close-btn" id="faceAuthCloseBtn">×</button>\n                    </div>\n                </div>\n                <div class="face-auth-body">\n                    <div class="face-auth-loading-container" id="faceAuthLoadingModels">\n                        <div class="face-auth-spinner"></div>\n                        <h3>Đang tải hệ thống</h3>\n                        <p>Xin đợi một lát...</p>\n                    </div>\n\n                    <div id="faceAuthCameraContent" class="face-auth-hidden">\n                        <div class="face-auth-content">\n                            <div class="face-auth-video-container">\n                                <video class="face-auth-video" id="faceAuthVideo" autoplay playsinline></video>\n                                <div class="face-auth-video-overlay">\n                                    <div class="face-auth-mask" id="faceAuthMask"></div>\n                                </div>\n                            </div>\n\n                            <div class="face-auth-sidebar">\n                                <div class="face-auth-instructions">\n                                    <ul>\n                                        <li>Giữ khuôn mặt ở giữa khung hình</li>\n                                        <li>Đảm bảo ánh sáng đầy đủ và rõ ràng</li>\n                                        <li>Giữ nguyên tư thế khi hệ thống đang xác thực</li>\n                                    </ul>\n                                </div>\n\n                                <div class="face-auth-status-container">\n                                    <div class="face-auth-status-text" id="faceAuthStatusText">Đang khởi tạo camera...</div>\n                                    <div class="face-auth-progress-container">\n                                        <div class="face-auth-progress-bar">\n                                            <div class="face-auth-progress-fill" id="faceAuthProgressFill"></div>\n                                        </div>\n                                        <div class="face-auth-progress-text" id="faceAuthProgressText">0%</div>\n                                    </div>\n                                </div>\n\n                                <div class="face-auth-error-message" id="faceAuthErrorMessage"></div>\n                                <div class="face-auth-success-message" id="faceAuthSuccessMessage"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            ';const t=document.createElement("canvas");t.id="faceAuthCanvas",t.className="face-auth-hidden",document.body.appendChild(n),document.body.appendChild(e),document.body.appendChild(t),this.injectStyles()}injectStyles(){if(document.getElementById("face-auth-styles"))return;document.head.insertAdjacentHTML("beforeend","\n                <style>\n                    .face-auth-overlay {\n                        position: fixed;\n                        top: 0;\n                        left: 0;\n                        width: 100%;\n                        height: 100%;\n                        background-color: rgba(0, 0, 0, 0.8);\n                        backdrop-filter: blur(12px);\n                        display: none;\n                        z-index: 10000;\n                        opacity: 0;\n                        transition: opacity 0.4s ease;\n                    }\n\n                    .face-auth-overlay.show { opacity: 1; }\n\n                    .face-auth-popup {\n                        position: fixed;\n                        top: 50%;\n                        left: 50%;\n                        transform: translate(-50%, -50%) scale(0.9);\n                        width: 95%;\n                        max-width: 850px;\n                        max-height: 90vh;\n                        background: linear-gradient(145deg, #1e1e1e, #1a1a1a);\n                        border-radius: 16px;\n                        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05);\n                        overflow: hidden;\n                        z-index: 10001;\n                        display: none;\n                        opacity: 0;\n                        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n                    }\n\n                    .face-auth-popup.show {\n                        transform: translate(-50%, -50%) scale(1);\n                        opacity: 1;\n                    }\n\n                    .face-auth-header {\n                        padding: 22px;\n                        border-bottom: 1px solid rgba(255, 255, 255, 0.08);\n                        display: flex;\n                        justify-content: space-between;\n                        align-items: center;\n                        background: rgba(30, 30, 30, 0.8);\n                    }\n\n                    .face-auth-title {\n                        font-size: 1.6rem;\n                        font-weight: 700;\n                        background: linear-gradient(90deg, #3a86ff, #5e9fff);\n                        -webkit-background-clip: text;\n                        -webkit-text-fill-color: transparent;\n                    }\n\n                    .face-auth-subtitle {\n                        font-size: 1rem;\n                        color: #b0b0b0;\n                        margin-top: 6px;\n                    }\n\n                    .face-auth-header-controls {\n                        display: flex;\n                        gap: 12px;\n                        align-items: center;\n                    }\n\n                    .face-auth-close-btn {\n                        background: rgba(255, 255, 255, 0.1);\n                        border: none;\n                        color: #b0b0b0;\n                        font-size: 1.5rem;\n                        cursor: pointer;\n                        width: 40px;\n                        height: 40px;\n                        border-radius: 50%;\n                        display: flex;\n                        align-items: center;\n                        justify-content: center;\n                        transition: all 0.3s ease;\n                    }\n\n                    .face-auth-close-btn:hover {\n                        background: rgba(255, 255, 255, 0.15);\n                        color: #ffffff;\n                        transform: rotate(90deg);\n                    }\n\n                    .face-auth-voice-toggle {\n                        background: rgba(255, 255, 255, 0.1);\n                        border: none;\n                        color: #b0b0b0;\n                        width: 40px;\n                        height: 40px;\n                        border-radius: 50%;\n                        display: flex;\n                        align-items: center;\n                        justify-content: center;\n                        cursor: pointer;\n                        transition: all 0.3s ease;\n                    }\n\n                    .face-auth-voice-toggle:hover {\n                        background: rgba(255, 255, 255, 0.15);\n                        color: #ffffff;\n                    }\n\n                    .face-auth-voice-toggle.active {\n                        color: #3a86ff;\n                        background: rgba(58, 134, 255, 0.2);\n                    }\n\n                    .face-auth-body {\n                        padding: 22px;\n                        overflow-y: auto;\n                        max-height: calc(90vh - 130px);\n                    }\n\n                    .face-auth-content {\n                        display: flex;\n                        gap: 24px;\n                        align-items: flex-start;\n                    }\n\n                    .face-auth-video-container {\n                        position: relative;\n                        width: 65%;\n                        aspect-ratio: 4/5;\n                        border-radius: 14px;\n                        overflow: hidden;\n                        background-color: #000;\n                        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);\n                        flex-shrink: 0;\n                    }\n\n                    .face-auth-video {\n                        width: 100%;\n                        height: 100%;\n                        object-fit: cover;\n                        transform: scaleX(-1);\n                    }\n\n                    .face-auth-video-overlay {\n                        position: absolute;\n                        top: 0;\n                        left: 0;\n                        width: 100%;\n                        height: 100%;\n                        pointer-events: none;\n                    }\n\n                    .face-auth-mask {\n                        position: absolute;\n                        top: 50%;\n                        left: 50%;\n                        transform: translate(-50%, -50%);\n                        width: 75%;\n                        height: 75%;\n                        border: 3px solid #3a86ff;\n                        border-radius: 50%;\n                        box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.7), 0 0 20px rgba(58, 134, 255, 0.4);\n                        transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);\n                    }\n\n                    .face-auth-mask.good {\n                        border-color: #2ed573;\n                        box-shadow: 0 0 0 9999px rgba(46, 213, 115, 0.1), 0 0 30px rgba(46, 213, 115, 0.5);\n                        animation: face-auth-pulse 2s infinite;\n                    }\n\n                    .face-auth-mask.warning {\n                        border-color: #ffa502;\n                        box-shadow: 0 0 0 9999px rgba(255, 165, 2, 0.1), 0 0 20px rgba(255, 165, 2, 0.4);\n                    }\n\n                    .face-auth-mask.error {\n                        border-color: #ff4757;\n                        box-shadow: 0 0 0 9999px rgba(255, 71, 87, 0.1), 0 0 20px rgba(255, 71, 87, 0.4);\n                    }\n\n                    @keyframes face-auth-pulse {\n                        0% { box-shadow: 0 0 0 9999px rgba(46, 213, 115, 0.1), 0 0 30px rgba(46, 213, 115, 0.5); }\n                        50% { box-shadow: 0 0 0 9999px rgba(46, 213, 115, 0.15), 0 0 40px rgba(46, 213, 115, 0.7); }\n                        100% { box-shadow: 0 0 0 9999px rgba(46, 213, 115, 0.1), 0 0 30px rgba(46, 213, 115, 0.5); }\n                    }\n\n                    .face-auth-sidebar {\n                        flex: 1;\n                        display: flex;\n                        flex-direction: column;\n                        gap: 20px;\n                    }\n\n                    .face-auth-instructions {\n                        text-align: left;\n                        background: rgba(255, 255, 255, 0.05);\n                        padding: 18px;\n                        border-radius: 14px;\n                        backdrop-filter: blur(10px);\n                        border: 1px solid rgba(255, 255, 255, 0.1);\n                    }\n\n                    .face-auth-instructions ul {\n                        list-style-type: none;\n                        padding-left: 0;\n                    }\n\n                    .face-auth-instructions li {\n                        margin-bottom: 12px;\n                        color: #b0b0b0;\n                        display: flex;\n                        align-items: center;\n                        transition: all 0.3s ease;\n                    }\n\n                    .face-auth-instructions li:hover {\n                        color: #ffffff;\n                        transform: translateX(5px);\n                    }\n\n                    .face-auth-instructions li:before {\n                        content: \"•\";\n                        color: #3a86ff;\n                        font-weight: bold;\n                        margin-right: 12px;\n                        font-size: 1.4rem;\n                    }\n\n                    .face-auth-status-container {\n                        text-align: center;\n                        background: rgba(255, 255, 255, 0.05);\n                        padding: 18px;\n                        border-radius: 14px;\n                        border: 1px solid rgba(255, 255, 255, 0.1);\n                    }\n\n                    .face-auth-status-text {\n                        font-size: 1.1rem;\n                        margin-bottom: 16px;\n                        min-height: 26px;\n                        font-weight: 500;\n                        transition: all 0.3s ease;\n                    }\n\n                    .face-auth-progress-container {\n                        width: 100%;\n                        margin-top: 12px;\n                    }\n\n                    .face-auth-progress-bar {\n                        width: 100%;\n                        height: 10px;\n                        background: rgba(255, 255, 255, 0.1);\n                        border-radius: 5px;\n                        overflow: hidden;\n                        position: relative;\n                    }\n\n                    .face-auth-progress-fill {\n                        height: 100%;\n                        background: linear-gradient(90deg, #3a86ff, #2ed573);\n                        border-radius: 5px;\n                        width: 0%;\n                        transition: width 0.5s ease;\n                        position: relative;\n                        overflow: hidden;\n                    }\n\n                    .face-auth-progress-fill::after {\n                        content: '';\n                        position: absolute;\n                        top: 0;\n                        left: -100%;\n                        width: 100%;\n                        height: 100%;\n                        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);\n                        animation: face-auth-shine 2s infinite;\n                    }\n\n                    @keyframes face-auth-shine {\n                        0% { left: -100%; }\n                        100% { left: 100%; }\n                    }\n\n                    .face-auth-progress-text {\n                        text-align: center;\n                        margin-top: 10px;\n                        font-size: 1rem;\n                        color: #b0b0b0;\n                        font-weight: 500;\n                    }\n\n                    .face-auth-error-message {\n                        color: #ff4757;\n                        margin-top: 16px;\n                        padding: 14px;\n                        background: rgba(255, 71, 87, 0.1);\n                        border-radius: 12px;\n                        display: none;\n                        border-left: 4px solid #ff4757;\n                    }\n\n                    .face-auth-success-message {\n                        color: #2ed573;\n                        margin-top: 16px;\n                        padding: 14px;\n                        background: rgba(46, 213, 115, 0.1);\n                        border-radius: 12px;\n                        display: none;\n                        border-left: 4px solid #2ed573;\n                    }\n\n                    .face-auth-loading-container {\n                        display: flex;\n                        flex-direction: column;\n                        align-items: center;\n                        justify-content: center;\n                        padding: 50px 20px;\n                        text-align: center;\n                    }\n\n                    .face-auth-spinner {\n                        width: 60px;\n                        height: 60px;\n                        border: 4px solid rgba(58, 134, 255, 0.3);\n                        border-radius: 50%;\n                        border-top-color: #3a86ff;\n                        animation: face-auth-spin 1s linear infinite;\n                        margin-bottom: 24px;\n                    }\n\n                    @keyframes face-auth-spin {\n                        0% { transform: rotate(0deg); }\n                        100% { transform: rotate(360deg); }\n                    }\n\n                    .face-auth-hidden {\n                        display: none;\n                    }\n\n                    .face-auth-fade-in {\n                        animation: face-auth-fadeIn 0.5s ease forwards;\n                    }\n\n                    @keyframes face-auth-fadeIn {\n                        from { opacity: 0; transform: translateY(20px); }\n                        to { opacity: 1; transform: translateY(0); }\n                    }\n\n                    @media (max-width: 900px) {\n                        .face-auth-popup { width: 98%; max-height: 95vh; }\n                        .face-auth-body { max-height: calc(95vh - 130px); padding: 18px; }\n                        .face-auth-header { padding: 18px; }\n                        .face-auth-content { flex-direction: column; }\n                        .face-auth-video-container { width: 100%; }\n                    }\n                </style>\n            ")}cacheDOMElements(){this.overlay=document.getElementById("faceAuthOverlay"),this.popup=document.getElementById("faceAuthPopup"),this.closeBtn=document.getElementById("faceAuthCloseBtn"),this.video=document.getElementById("faceAuthVideo"),this.statusText=document.getElementById("faceAuthStatusText"),this.progressText=document.getElementById("faceAuthProgressText"),this.progressFill=document.getElementById("faceAuthProgressFill"),this.errorMessage=document.getElementById("faceAuthErrorMessage"),this.successMessage=document.getElementById("faceAuthSuccessMessage"),this.canvas=document.getElementById("faceAuthCanvas"),this.loadingModels=document.getElementById("faceAuthLoadingModels"),this.cameraContent=document.getElementById("faceAuthCameraContent"),this.faceMask=document.getElementById("faceAuthMask"),this.voiceToggle=document.getElementById("faceAuthVoiceToggle")}}}()}},e={},function t(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={exports:{}};return n[a].call(o.exports,o,o.exports,t),o.exports}(291).default;var n,e});